[tool:pytest]
# Pytest configuration for TranscriptX
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Markers for test categorization
markers =
    smoke: fast, deterministic, no external services/models; required for CI
    unit: Unit tests for individual functions/classes
    integration: Integration tests for workflows and pipelines
    slow: Tests that take longer to run (ML models, file I/O)
    requires_models: Tests that require downloaded ML models
    requires_docker: Tests that require a Docker daemon or containers
    requires_ffmpeg: Tests that require ffmpeg/ffprobe on PATH
    requires_api: Tests that require external API access
    database: Tests that require database setup
    performance: Performance and benchmark tests
    timeout: Tests that may legitimately take longer than 5 minutes

# Test discovery
collect_ignore = setup.py build dist *.egg-info node_modules frontend/dist

# Output options
addopts = 
    -ra
    --strict-markers
    --strict-config
    --verbose
    --tb=short
    --timeout=300
    --timeout-method=thread
    --cov=src/transcriptx
    --cov-report=term-missing
    --cov-report=html:htmlcov
    --cov-report=xml:coverage.xml
    --cov-fail-under=80
    --cov-branch
    --cov-config=.coveragerc

# Filter warnings
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore::UserWarning:transformers.*
    ignore::UserWarning:torch.*
    ignore::UserWarning:sklearn.*

# Minimum version
minversion = 7.0
